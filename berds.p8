pico-8 cartridge // http://www.pico-8.com
version 18
__lua__
-- berds
-- by primarter

width = 128
height = 128

function _init()
 invi = false
 pause = false
 gt = 0
 t_char = 0
 t_en = 0
 st = 4
 x_char = 16
 y_char = 56
 x_en = 112
 y_en = 56
 char_anim = 1
 en_anim = 4
 char_flp = false
 en_flp = false
end

function _paused()
 pause = true
end

function _update()
 gt += 1
 pause = false

 -- player 2 move
 if (btn(0, 1)) then
  x_char -= 3
  char_flp = true
 end
 if (btn(1, 1)) then
  x_char += 3
  char_flp = false
 end
 if (btn(3, 1)) then
  y_char += 3
 end
 if (btn(2, 1)) then
  y_char -= 3
 end

 -- player 1 move
 if (btn(0, 0)) then
  x_en -= 3
  en_flp = false
 end
 if (btn(1, 0)) then
  x_en += 3
  en_flp = true
 end
 if (btn(3, 0)) then
  y_en += 3
 end
 if (btn(2, 0)) then
  y_en -= 3
 end

 -- players animations
 t_char += 1
 t_en += 1
 if (t_en % 7 == 0) then
  en_anim = (en_anim == 4) and 5 or 4
  t_en = 0
 end
 if (t_char % 5 == 0) then
  char_anim = (char_anim == 1) and 2 or 1
  t_char = 0
 end

 -- collisions
 if (collide()) then
  st = 1
 end
 x_char, y_char = side_collision(x_char, y_char)
 x_en, y_en = side_collision(x_en, y_en)
 invi = check_invi(x_char, y_char)

 -- start
 if (st == 4 and btn(4, 1)) then
  st = 3
 end

 -- restart
 if (st == 1 and btn(4, 1)) then
  st = 2
 end
end

function _draw()
 if (pause == false) then
  cls()

  if (st == 4) then
   my_menu()
   return
  end
  if (st == 3) then
   dr_restart()
  else
   map(0, 0, 0, 0, 16, 16, 0)
  end
  if (st == 0) then
   spr(en_anim, x_en, y_en, 1, 1, en_flp, false)
   if (invi == false) then
    spr(char_anim, x_char, y_char, 1, 1, char_flp, false)
   end
  elseif (st == 1) then
   print('player 1 died', 36, 48, 8)
   print('press tab to restart', 24, 64, 8)
  else
   st = 3
   _init()
  end
 end
end
-->8
function collide()
 if (y_en >= y_char and y_en <= y_char + 8 and x_en >= x_char and x_en <= x_char + 8) then
   return true
 end
 if (y_en + 8 >= y_char and y_en + 8 <= y_char + 8 and x_en >= x_char and x_en <= x_char + 8) then
  return true
 end
 if (y_en >= y_char and y_en <= y_char + 8 and x_en + 8 >= x_char and x_en + 8 <= x_char + 8) then
   return true
 end
 if (y_en + 8 >= y_char and y_en + 8 <= y_char + 8 and x_en + 8 >= x_char and x_en + 8 <= x_char + 8) then
   return true
 end
 return false
end

function side_collision(sp_x, sp_y)
 test = false
 if (sp_x <= 0) then
  sp_x = 0
  test = true
 end
 if (sp_y <= 0) then
  sp_y = 0
  test = true
 end
 if (sp_x + 8 >= width) then
  sp_x = 120
  test = true
 end
 if (sp_y + 8 >= height) then
  sp_y = 120
  test = true
 end
 return sp_x, sp_y, test
end

function check_invi(x, y)
 x -= 1
 y -= 1
 if (fget(mget((x + 0) / 8, (y + 0) / 8), 2) == true) and
    (fget(mget((x + 7) / 8, (y + 7) / 8), 2) == true) and
    (fget(mget((x + 7) / 8, (y + 0) / 8), 2) == true) and
    (fget(mget((x + 0) / 8, (y + 7) / 8), 2) == true) then
  return true
 end
 return false
end

function check_zone(x, y)
end

function sleep(n) 
 for i=1, n*30 do
  flip()
 end
end
-->8
function dr_restart()
 cls()
 map(0, 0, 0, 0, 16, 16, 0)
 print('ready?', 52, 56, 8)
 sleep(1.5)
 cls()
 map(0, 0, 0, 0, 16, 16, 0)
 print('chase!', 52, 56, 8)
 sleep(0.75)
 st = 0
end
-->8
function my_menu()
 cls()
  
 for i=1,11 do
  for j0=0,7 do
  j = 7-j0
  col = 7+j
  t1 = gt + i*4 - j*2
  x = cos(t0)*5
  y = 38 + j + cos(t1/50)*5
  pal(7,col)
  spr(18+i, 8+i*8 + x, y)
  end
 end

  print("this is berds!",
    37, 70, 14) --8+(t/4)%8)
    print("press tab to play",
    30, 80, 12) --8+(t/4)%8)

  spr(0, 48, 90)
  spr(3, 72, 90)
end
__gfx__
000000000000000000000000000000000000000000000000ccccccccccccccccccccc77ccccccccceeeeeeeeeeeeeeeee22222222222222e2222222222222222
0bbbbbb000a0bbb00000bbb0022222200222288002222220ccccccccc777cccccc77777ccccccccce22222222222222ee22222222222222e2222222222222222
073333700a9ab37000bbb370021111202111811821111112ccccccccc777777c77777777cc7777cce22222222222222ee22222222222222e2222222222222222
063333600a99a3600b33336002eeee20ee181118ee118812cccccccc7777777777777777cc77777ce22222222222222ee22222222222222e2222222222222222
ab3bb3bab3aa333bb3aa333b828888288818118288181182cccccccc7777776776666667c7777767e22222222222222ee22222222222222e2222222222222222
9a3883a90bb333b80a99a3b816766761676e88e267681118ccccccccc77666677777777777666667e22222222222222ee22222222222222e2222222222222222
aabbbbaa000bbbb00a9abbb08162261826eeeee226ee8118cccccccccc777777cccccc7c77777777e22222222222222ee22222222222222e2222222222222222
a000000a0000000000a00000880000880222222002222880cccccccccccccccccccccccccccccc7ce22222222222222eeeeeeeeeeeeeeeee22222222eeeeeeee
eeeeeeeee22222222222222e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
22222222e22222222222222e07777700077777700777770007777000077777700000000007777770077007700077770007777770077777700000000000000000
22222222e22222222222222e07700070077000000770007007700770077000000000000007700000077007700770077007700000077000000000000000000000
22222222e22222222222222e07700070077000000777770007700770077000000000000007700000077007700770077007700000077000000000000000000000
22222222e22222222222222e07777700077770000770700007700770077777700000000007700000077777700777777007777770077770000000000000000000
22222222e22222222222222e07700070077000000770070007700770000007700000000007700000077007700770077000000770077000000000000000000000
22222222e22222222222222e07777700077777700770007007777770077777700000000007777770077007700770077007777770077777700000000000000000
22222222e22222222222222e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0001010002020000000004040404040404040400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0606060706060606060606060606060600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
060606060607060906060a10100b060700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
06080606060606060706110e0e12060600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
060606070606080606060c0f0f0d070600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0609060606060609060606060706060600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0606060906070606060906060606060600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0607060606060806060606060906080600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0606060606060607060608060606060600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0706060706060806060606060608060600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0606060606060606090606060706060600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0806060806070606060607060606070600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0606060606060608060906060608060600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0607060606090606060606070606060600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
060a10100b060706060606060606070600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
06110e0e12060606070608060606060600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
070c0f0f0d060607060606080607060700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0606090606060906080606060906060600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0906060609060606060806060606060700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
0010000000472004620c3400c34318470004313102500415000702905500375183750c3000c3751f4730c375053720536211540114330c37524555247120c3730a470163521d07522375164120a211220252e315
01100000183732440518433394033c65539403185432b543184733940318433394033c655306053940339403184733940318423394033c655394031845321433184733940318473394033c655394033940339403
01100000247552775729755277552475527755297512775524755277552b755277552475527757297552775720755247572775524757207552475227755247522275526757297552675722752267522975526751
01100000001750c055003550c055001750c055003550c05500175180650c06518065001750c065003650c065051751106505365110650c17518075003650c0650a145160750a34516075111451d075113451d075
011000001b5771f55722537265171b5361f52622515265121b7771f76722757267471b7461f7362271522712185771b5571d53722517187361b7261d735227122454527537295252e5171d73514745227452e745
01100000275422754227542275422e5412e5452b7412b5422b5452b54224544245422754229541295422954224742277422e7422b7422b5422b5472954227542295422b742307422e5422e7472b547305462e742
0110000030555307652e5752b755295622e7722b752277622707227561297522b072295472774224042275421b4421b5451b5421b4421d542295471d442295422444624546245472444727546275462944729547
0110000000200002000020000200002000020000200002000020000200002000020000200002000020000200110171d117110171d227131211f227130371f2370f0411b1470f2471b35716051221571626722367
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002e775000002e1752e075000002e1752e77500000
__music__
00 00044208
00 00044108
00 00010304
00 00010304
01 00010203
00 00010203
00 00010305
00 00010306
00 00010305
00 00010306
00 00010245
02 00010243

